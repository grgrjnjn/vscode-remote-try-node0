const kuromoji = require('kuromoji');

function extractPlaces(text) {
  return new Promise((resolve, reject) => {
    kuromoji.builder({ dicPath: 'node_modules/kuromoji/dict' }).build((err, tokenizer) => {
      if (err) {
        reject(err);
        return;
      }

      const tokens = tokenizer.tokenize(text);
      const places = tokens.filter(token => {
        // åœ°åã¨æ€ã‚ã‚Œã‚‹å“è©žã‚’æŠ½å‡º
        return (
          (token.pos === 'åè©ž' && token.pos_detail_1 === 'å›ºæœ‰åè©ž' && token.pos_detail_2 === 'åœ°åŸŸ') ||
          (token.pos === 'åè©ž' && token.pos_detail_1 === 'å›ºæœ‰åè©ž' && token.pos_detail_2 === 'ä¸€èˆ¬' && token.pos_detail_3 === 'åœ°å') ||
          (token.pos === 'åè©ž' && token.pos_detail_1 === 'æŽ¥å°¾' && token.pos_detail_2 === 'åœ°åŸŸ')
        );
      }).map(token => token.surface_form);

      resolve(places);
    });
  });
}

// ä½¿ç”¨ä¾‹
// const text = "æ˜Žæ—¥ã¯æ±äº¬éƒ½æ–°å®¿åŒºã§ä¼šè­°ãŒã‚ã‚Šã¾ã™ã€‚ãã®å¾Œã€å¤§é˜ªåºœã«å‡ºå¼µã—ã€äº¬éƒ½å¸‚ã‚’è¦³å…‰ã—ã¾ã™ã€‚";

// const text = "ã“ã‚Œã‹ã‚‰æ–°å®¿ã§ç„¡ç†ã‚„ã‚Šã—ã¦ãã‚Œã‚‹æ–¹ã„ã¾ã›ã‚“ã‹ï¼Ÿ\nãƒžã‚¹ã‚¯å¥³è£…ã§ç©´ä½¿ãˆã¾ã›ã‚“ãŒã€ãã‚Œã§ã‚‚è‰¯ã‘ã‚Œã°\n168.49.20ã€å ´æ‰€ãªã—ã§ã™";
// const text = "ã‚µã‚ã‚Šã§å ´æ‰€ã‚ã‚Šï¼é«˜ç”°é¦¬å ´ã§ä¼šãˆã‚‹äººã€é€†ã‚¢ãƒŠã•ã‚ŒãŸã„ç”·å‹Ÿé›†ï¼å†·ã‚„ã‹ã—ã•ã‚“ã¯ãŠæ–­ã‚Šã§ã™ã€‚ãƒ—ãƒ­ãƒ•ãŒã‚ã‚‹ã¨è¿”ä¿¡ã—ã‚„ã™ã„ã§ã™ã€‚Xã‚’è¦‹ã¦èˆˆå‘³ã‚ã£ãŸã‚‰DMãã ã•ã„ðŸ¥°";
// const text = "é«˜ç”°é¦¬å ´ã§ä»Šæ—¥ä¼šãˆã‚‹äººã„ã¾ã™ã‹ï¼Ÿ\nMå¯„ã‚Šã§è²¬ã‚ã‚‰ã‚Œã‚‹ã®ãŒå¥½ã\nãƒ—ãƒ­ãƒ•ã¨é¡”å†™çœŸãã ã•ã„";
// const text = "ãŠæ™‚é–“ã‚ã‚‹æ–¹è‘›é£¾æ–¹é¢è‡ªå®…æ¥ã¦ãã ã•ã„ï¼ã‚¨ãƒƒãƒã—ã¾ã‚‡ðŸ©·ã‚¢ãƒŠãƒ«ï¼ãŠå£ã—ã¾ã™ã€‚èƒ¸ç„¡ã—ç«¿å°ã•ã‚å®Œå…¨å¥³è£…å¨˜";
const text = "168ã‚»ãƒ³ãƒ98ã‚­ãƒ­24æ­³ã€Hã‚«ãƒƒãƒ—ã‚ã‚Šã‚ã‚Šãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ãƒ•ã€‚éƒ½å†…ã‹ã‚‰\nãŠæ™‚é–“åˆãˆã°éŠã‚“ã§ãã ã•ã„ã€‚\nå¤ªã£ã¦ã¾ã™ãŒã€è‰¯ã‘ã‚Œã°ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™";
// const text = "ãŠãªã§ã‚“ã—ã¾ã›ã‚“ã‹ï¼Ÿ\nãƒ“ãƒ‡ã‚ªã§ã„ã˜ã‚ãŸã„ã§ã™â˜ºï¸ðŸ’—\nãºã„ãºã„0.25ç¢ºèªã§ããŸã‚‰ã‹ã‘ã¾ã™ï¼\nè¦‹ã›åˆã„ã£ã“ã§ã‚‚ðŸ™†ðŸ¼â€â™€ï¸";
// const text = "æ–°å®¿ãƒ›ãƒ†ãƒ«ã§ãŠæ‰‹ã¦ã‚ã‚Šã§ãŠä¼šã„ã§ãã‚‹æ–¹å‹Ÿé›†ã—ã¦ã¾ã™ðŸ’°\n176.67.23ã€ãƒ›ãƒ«Dã‚«ãƒƒãƒ—ã€ã‚¢ãƒªã‚¢ãƒªã€‚ãƒ¢ãƒãƒ¢ãƒãƒ„ãƒ«ã‚¹ãƒ™è‚Œã§ã™âœ¨ï¸\nå…¨èº«æ€§æ„Ÿå¸¯ã§ã™ã€ã‚¢ãƒŠãƒ«.ä¹³é¦–ç‰¹ã«æ„Ÿã˜ã¾ã™â—ŽAFå¥½ãã§ã™ï¼ï¼\nãŠåº—ã«ã‚‚ã„ãŸã®ã§ãƒ†ã‚¯ãªã©è‡ªä¿¡ã‚ã‚Šã¾ã™ðŸ‘ðŸ»\né€†ã‚¢ãƒŠã€å°„ç²¾ã€èº«ä½“ã«å‚·ãŒã¤ãã“ã¨âŒã€\nè»½ã‚ã¯1ï½ž\nï½¢ãƒ—ãƒ­ãƒ•ã€ã‚„ã‚ŠãŸã„ã“ã¨ã€æ—¥æ™‚ã€ãƒ—ãƒ¬ã‚¤æ™‚é–“ã¨æ–™é‡‘ã€ï¼ˆå‡ºæ¥ãŸã‚‰é¡”å†™çœŸï¼‰ï½£\nãªã©ã‚’è¼‰ã›ã¦ã”é€£çµ¡ãã ã•ã„ã€‚\nã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™\nâš ï¸ã‚«ã‚«ã‚ªä½¿ãˆãªããªã‚Šã¾ã—ãŸã€‚ã‚„ã‚Šå–ã‚Šã—ã¦ãŸæ–¹ãƒ¡ãƒ¼ãƒ«ã—ã¦ãã‚Œã‚‹ã¨å¬‰ã—ã„ã§ã™ðŸ™‡â€â™€ï¸\nå†™çœŸã¯æœ¬äººã§ã™ã€åŠ å·¥ã—ã¦ãªã„ã€‚\nä»–ã«å†™çœŸã¯è¦‹ã›ãŸã‚Šã—ã¦ã¾ã›ã‚“ã€æœ‰æ–™ã§ã™ã€‚\nè¦‹ãŸã‹ã£ãŸã‚‰ç”»åƒæ¤œç´¢ã—ã¦ãã ã•ã„ã€‚";
// const text = "ãŠãªã§ã‚“ã—ã¾ã›ã‚“ã‹ï¼Ÿ\nãƒ“ãƒ‡ã‚ªã§ã„ã˜ã‚ãŸã„ã§ã™â˜ºï¸ðŸ’—\nãºã„ãºã„0.25ç¢ºèªã§ããŸã‚‰ã‹ã‘ã¾ã™ï¼\nè¦‹ã›åˆã„ã£ã“ã§ã‚‚ðŸ™†ðŸ¼â€â™€ï¸";
// const text = "ç”»åƒã®äººç‰©ãƒ’ãƒ‰ãƒ³ãƒŠã¯å…¨ã¦åŒä¸€äººç‰©ã§ã‚ã‚Šã€ã©ç”°èˆŽã‹ã‚‰è¶³ç«‹åŒºã¸ç§»ä½ã—ã¦ããŸç”°èˆŽè€…ã§ä½Žå­¦æ­´è€…ã§å…ƒä»‹è­·å£«ã§ãƒã‚²ã§ï¼“ï¼ä»£ã®ãƒ¢ãƒ¼ãƒ›ãƒ¼ã§ã™ã€‚\nç›®ã‚’ç¾Žå®¹æ•´å½¢ã—ã¾ã—ãŸæ·»ä»˜ç”»åƒï¼‘ã€‚\n\nãµã‚ã£ã¡é…ä¿¡è€…ã¨è¿·æƒ‘ãƒ¦ãƒ¼ãƒãƒ¥ãƒ¼ãƒãƒ¼ã§ã‚ã‚Šè»Šã§ä¼šã„ã«è¡Œãç´„æŸã‚’ã—ç”Ÿé…ä¿¡ã§åž‚ã‚Œæµã™ã‚ˆï¼\n\nã€Ž å‡ºä¼šã„ç³»ã§ç”·ã¨ä¼šã„é…ä¿¡ã§æµã™è¶³ç«‹åŒº è‚¥æº€å¥³è£… ã€ã§ã€æ¤œç´¢ï¼\n\nãƒ’ãƒ‰ãƒ³ãƒŠã¯é ­ãŒå¼±ãæ¥µæ‚ªãªå…ƒä»‹è­·å£«ã€æ–½è¨­ã«ã„ã‚‹å¹´å¯„ã‚Šã‚’ã‚¤ã‚¸ãƒ¡ã¦ã„ãŸã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚";
// const text = "ã“ã‚Œã‹ã‚‰æ± è¢‹ã§ç„¡ç†ã‚„ã‚Šã—ã¦ãã‚Œã‚‹æ–¹ã„ã¾ã›ã‚“ã‹ï¼Ÿãƒžã‚¹ã‚¯å¥³è£…ã§ç©´ä½¿ãˆã¾ã›ã‚“ãŒã€ãã‚Œã§ã‚‚è‰¯ã‘ã‚Œã°\n168.49.20ã€å ´æ‰€ãªã—ã§ã™";



extractPlaces(text)
  .then(places => {
    console.log('æŠ½å‡ºã•ã‚ŒãŸåœ°å:', places);
  })
  .catch(err => {
    console.error('ã‚¨ãƒ©ãƒ¼:', err);
  });